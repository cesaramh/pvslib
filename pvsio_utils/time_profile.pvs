time_profile[T:TYPE+] : THEORY
BEGIN

  IMPORTING time_tictoc

  % Time execution of a function
  time_profile_aux(fun:T) : MACRO [T,Toc] =
    prog(tic,(fun,toc))

  time_profile(fun:T) : MACRO T =
    LET (result,atoc) = time_profile_aux(fun) IN  
      prog(print(str_toc(atoc)),
    	   result)

END time_profile
